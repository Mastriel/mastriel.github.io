var at=Object.defineProperty;var ft=(t,e,n)=>e in t?at(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var _=(t,e,n)=>(ft(t,typeof e!="symbol"?e+"":e,n),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&s(u)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerpolicy&&(o.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?o.credentials="include":i.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();function P(){}function Ge(t){return t()}function Pe(){return Object.create(null)}function $(t){t.forEach(Ge)}function Je(t){return typeof t=="function"}function F(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}let me;function fe(t,e){return me||(me=document.createElement("a")),me.href=e,t===me.href}function dt(t){return Object.keys(t).length===0}function Qe(t,...e){if(t==null)return P;const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function V(t){let e;return Qe(t,n=>e=n)(),e}function B(t,e,n){t.$$.on_destroy.push(Qe(e,n))}function v(t,e){t.appendChild(e)}function E(t,e,n){t.insertBefore(e,n||null)}function k(t){t.parentNode&&t.parentNode.removeChild(t)}function b(t){return document.createElement(t)}function pe(t){return document.createTextNode(t)}function S(){return pe(" ")}function Ce(){return pe("")}function j(t,e,n,s){return t.addEventListener(e,n,s),()=>t.removeEventListener(e,n,s)}function m(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function pt(t){return Array.from(t.childNodes)}function We(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function O(t,e,n,s){n===null?t.style.removeProperty(e):t.style.setProperty(e,n,s?"important":"")}function Me(t,e){return new t(e)}let de;function ue(t){de=t}function ht(){if(!de)throw new Error("Function called outside component initialization");return de}function $e(t){ht().$$.on_mount.push(t)}const ce=[],be=[],_e=[],Be=[],mt=Promise.resolve();let Ie=!1;function wt(){Ie||(Ie=!0,mt.then(et))}function ze(t){_e.push(t)}const Ee=new Set;let we=0;function et(){const t=de;do{for(;we<ce.length;){const e=ce[we];we++,ue(e),_t(e.$$)}for(ue(null),ce.length=0,we=0;be.length;)be.pop()();for(let e=0;e<_e.length;e+=1){const n=_e[e];Ee.has(n)||(Ee.add(n),n())}_e.length=0}while(ce.length);for(;Be.length;)Be.pop()();Ie=!1,Ee.clear(),ue(t)}function _t(t){if(t.fragment!==null){t.update(),$(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(ze)}}const ge=new Set;let G;function xe(){G={r:0,c:[],p:G}}function Se(){G.r||$(G.c),G=G.p}function X(t,e){t&&t.i&&(ge.delete(t),t.i(e))}function q(t,e,n,s){if(t&&t.o){if(ge.has(t))return;ge.add(t),G.c.push(()=>{ge.delete(t),s&&(n&&t.d(1),s())}),t.o(e)}else s&&s()}function gt(t,e){t.d(1),e.delete(t.key)}function bt(t,e){q(t,1,1,()=>{e.delete(t.key)})}function tt(t,e,n,s,i,o,u,c,a,l,d,f){let p=t.length,r=o.length,h=p;const y={};for(;h--;)y[t[h].key]=h;const x=[],z=new Map,T=new Map;for(h=r;h--;){const I=f(i,o,h),C=n(I);let w=u.get(C);w?s&&w.p(I,e):(w=l(C,I),w.c()),z.set(C,x[h]=w),C in y&&T.set(C,Math.abs(h-y[C]))}const A=new Set,M=new Set;function H(I){X(I,1),I.m(c,d),u.set(I.key,I),d=I.first,r--}for(;p&&r;){const I=x[r-1],C=t[p-1],w=I.key,W=C.key;I===C?(d=I.first,p--,r--):z.has(W)?!u.has(w)||A.has(w)?H(I):M.has(W)?p--:T.get(w)>T.get(W)?(M.add(w),H(I)):(A.add(W),p--):(a(C,u),p--)}for(;p--;){const I=t[p];z.has(I.key)||a(I,u)}for(;r;)H(x[r-1]);return x}function oe(t){t&&t.c()}function J(t,e,n,s){const{fragment:i,after_update:o}=t.$$;i&&i.m(e,n),s||ze(()=>{const u=t.$$.on_mount.map(Ge).filter(Je);t.$$.on_destroy?t.$$.on_destroy.push(...u):$(u),t.$$.on_mount=[]}),o.forEach(ze)}function Q(t,e){const n=t.$$;n.fragment!==null&&($(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function vt(t,e){t.$$.dirty[0]===-1&&(ce.push(t),wt(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function ee(t,e,n,s,i,o,u,c=[-1]){const a=de;ue(t);const l=t.$$={fragment:null,ctx:[],props:o,update:P,not_equal:i,bound:Pe(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(a?a.$$.context:[])),callbacks:Pe(),dirty:c,skip_bound:!1,root:e.target||a.$$.root};u&&u(l.root);let d=!1;if(l.ctx=n?n(t,e.props||{},(f,p,...r)=>{const h=r.length?r[0]:p;return l.ctx&&i(l.ctx[f],l.ctx[f]=h)&&(!l.skip_bound&&l.bound[f]&&l.bound[f](h),d&&vt(t,f)),p}):[],l.update(),d=!0,$(l.before_update),l.fragment=s?s(l.ctx):!1,e.target){if(e.hydrate){const f=pt(e.target);l.fragment&&l.fragment.l(f),f.forEach(k)}else l.fragment&&l.fragment.c();e.intro&&X(t.$$.fragment),J(t,e.target,e.anchor,e.customElement),et()}ue(a)}class te{$destroy(){Q(this,1),this.$destroy=P}$on(e,n){if(!Je(n))return P;const s=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return s.push(n),()=>{const i=s.indexOf(n);i!==-1&&s.splice(i,1)}}$set(e){this.$$set&&!dt(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const se=[];function N(t,e=P){let n;const s=new Set;function i(c){if(F(t,c)&&(t=c,n)){const a=!se.length;for(const l of s)l[1](),se.push(l,t);if(a){for(let l=0;l<se.length;l+=2)se[l][0](se[l+1]);se.length=0}}}function o(c){i(c(t))}function u(c,a=P){const l=[c,a];return s.add(l),s.size===1&&(n=e(i)||P),c(t),()=>{s.delete(l),s.size===0&&(n(),n=null)}}return{set:i,update:o,subscribe:u}}function yt(){return{close:!0,minimize:!0,maximize:!1}}class kt{constructor(e,n,s,i){_(this,"stores");this.stores=new Et(e,n,s,i)}get x(){return V(this.stores.x)}set x(e){this.stores.x.set(e)}get y(){return V(this.stores.y)}set y(e){this.stores.y.set(e)}get zIndex(){return V(this.stores.zIndex)}set zIndex(e){this.stores.zIndex.set(e)}get width(){return V(this.stores.width)}set width(e){this.stores.width.set(e)}get height(){return V(this.stores.height)}set height(e){this.stores.height.set(e)}get title(){return V(this.stores.title)}set title(e){this.stores.title.set(e)}get classes(){return V(this.stores.classes)}set classes(e){this.stores.classes.set(e)}get style(){return V(this.stores.style)}set style(e){this.stores.style.set(e)}get resizable(){return V(this.stores.resizable)}set resizable(e){this.stores.resizable.set(e)}get important(){return V(this.stores.important)}set important(e){this.stores.important.set(e)}get isVisible(){return V(this.stores.isVisible)}set isVisible(e){this.stores.isVisible.set(e)}get icon(){return V(this.stores.icon)}set icon(e){this.stores.icon.set(e)}get controlButtons(){return V(this.stores.controlButtons)}set controlButtons(e){this.stores.controlButtons.set(e)}}class Et{constructor(e,n,s,i){_(this,"classes",N(""));_(this,"style",N(""));_(this,"title",N());_(this,"icon",N());_(this,"resizable",N(!1));_(this,"important",N(!1));_(this,"isVisible",N(!0));_(this,"controlButtons",N(yt()));_(this,"height");_(this,"width");_(this,"x");_(this,"y");_(this,"zIndex",N(0));this.x=N(e),this.y=N(n),this.width=N(s),this.height=N(i)}}const D=class extends kt{constructor(n,s,i,o,u){super(n,s,i,o);_(this,"_process");_(this,"windowElement");_(this,"onPopInEnd",n=>{let s=i=>{i.animationName=="pop-in"&&(this.windowElement.removeEventListener("animationend",s),n())};this.windowElement.onanimationend=s});_(this,"playCloseAnimation",()=>{this.windowElement.classList.remove("window-spawn"),this.windowElement.style.animationDirection="reverse",this.windowElement.offsetWidth,this.windowElement.classList.add("window-spawn")});_(this,"kill",()=>{let n=D.windows.filter(s=>s!=this);D.windowsStore.set(n),this.process.getWindows().length==0&&this.process.kill()});this.component=u}static get activeWindow(){return V(this.activeWindowStore)}static set activeWindow(n){this.activeWindowStore.set(n)}static getWindows(){return[...this.windows]}get process(){return this._process}get isAlive(){return this._process!=null}get isActive(){return D.activeWindow==this}get isVisible(){return V(this.stores.isVisible)}set isVisible(n){n?this.stores.isVisible.set(n):(this.playCloseAnimation(),this.onPopInEnd(()=>this.stores.isVisible.set(n)))}hide(){this.isVisible=!1}unhide(){this.isVisible=!0}close(){this.playCloseAnimation(),this.onPopInEnd(this.kill)}};let L=D;_(L,"windowsStore",N([])),_(L,"windows"),_(L,"activeWindowStore",N(void 0)),_(L,"spawn",(n,s)=>(D.windowsStore.set([...D.windows,n]),n._process=s,n.title=n.process.app.name,n)),(()=>{D.windowsStore.subscribe(n=>{D.windows=n})})();let nt=0;const ae=()=>nt++,Ve=()=>nt;function Ne(t){let e;return{c(){e=b("div"),O(e,"height",t[2]+"px"),O(e,"width",t[5]+"px"),m(e,"class","absolute")},m(n,s){E(n,e,s)},p(n,s){s&4&&O(e,"height",n[2]+"px"),s&32&&O(e,"width",n[5]+"px")},d(n){n&&k(e)}}}function It(t){let e,n,s,i,o,u=t[1]&&Ne(t);var c=t[0].component;function a(l){return{props:{window:l[0],process:l[0].process}}}return c&&(s=Me(c,a(t))),{c(){e=b("div"),u&&u.c(),n=S(),s&&oe(s.$$.fragment),m(e,"style",i="height: "+t[2]+"px;"+t[3]),m(e,"class",t[4])},m(l,d){E(l,e,d),u&&u.m(e,null),v(e,n),s&&J(s,e,null),o=!0},p(l,[d]){l[1]?u?u.p(l,d):(u=Ne(l),u.c(),u.m(e,n)):u&&(u.d(1),u=null);const f={};if(d&1&&(f.window=l[0]),d&1&&(f.process=l[0].process),c!==(c=l[0].component)){if(s){xe();const p=s;q(p.$$.fragment,1,0,()=>{Q(p,1)}),Se()}c?(s=Me(c,a(l)),oe(s.$$.fragment),X(s.$$.fragment,1),J(s,e,null)):s=null}else c&&s.$set(f);(!o||d&12&&i!==(i="height: "+l[2]+"px;"+l[3]))&&m(e,"style",i),(!o||d&16)&&m(e,"class",l[4])},i(l){o||(s&&X(s.$$.fragment,l),o=!0)},o(l){s&&q(s.$$.fragment,l),o=!1},d(l){l&&k(e),u&&u.d(),s&&Q(s)}}}function zt(t,e,n){let s,i,o,u,{window:c}=e,{notImportant:a}=e,{style:l,classes:d,height:f,width:p}=c.stores;return B(t,l,r=>n(3,i=r)),B(t,d,r=>n(4,o=r)),B(t,f,r=>n(2,s=r)),B(t,p,r=>n(5,u=r)),t.$$set=r=>{"window"in r&&n(0,c=r.window),"notImportant"in r&&n(1,a=r.notImportant)},[c,a,s,i,o,u,l,d,f,p]}class Ct extends te{constructor(e){super(),ee(this,e,zt,It,F,{window:0,notImportant:1})}}function Oe(t){let e,n,s,i,o,u,c,a,l,d,f,p,r,h,y=t[8]!==void 0&&t[8].length!==0&&je(t);function x(w,W){return w[10]===w[0]?xt:Wt}let z=x(t),T=z(t),A=t[11].minimize&&Xe(),M=t[11].maximize&&Ye();function H(w,W){return w[11].close?Tt:St}let I=H(t),C=I(t);return f=new Ct({props:{window:t[0],notImportant:t[2]}}),{c(){e=b("div"),n=b("div"),s=b("div"),y&&y.c(),i=S(),T.c(),o=S(),u=b("div"),c=b("span"),A&&A.c(),a=S(),M&&M.c(),l=S(),C.c(),d=S(),oe(f.$$.fragment),m(s,"class","flex items-center"),m(c,"class","pr-2.5 mb-1"),m(u,"class","flex items-center"),m(n,"class","h-7 flex justify-between title-bar text-sm rounded-t-md rounded-sm select-none svelte-jpt6my"),O(n,"width",t[4]-2+"px"),m(e,"class","absolute border rounded-t-md rounded-sm border-gray-800 drop-shadow-md window-spawn"),O(e,"width",t[4]+"px"),O(e,"left",t[5]+"px"),O(e,"top",t[6]+"px"),O(e,"z-index",t[7])},m(w,W){E(w,e,W),v(e,n),v(n,s),y&&y.m(s,null),v(s,i),T.m(s,null),v(n,o),v(n,u),v(u,c),A&&A.m(c,null),v(c,a),M&&M.m(c,null),v(c,l),C.m(c,null),t[26](n),v(e,d),J(f,e,null),t[27](e),p=!0,r||(h=[j(n,"mousedown",t[22]),j(n,"mouseup",t[23]),j(n,"mousemove",t[24]),j(e,"mousedown",t[20])],r=!0)},p(w,W){w[8]!==void 0&&w[8].length!==0?y?y.p(w,W):(y=je(w),y.c(),y.m(s,i)):y&&(y.d(1),y=null),z===(z=x(w))&&T?T.p(w,W):(T.d(1),T=z(w),T&&(T.c(),T.m(s,null))),w[11].minimize?A||(A=Xe(),A.c(),A.m(c,a)):A&&(A.d(1),A=null),w[11].maximize?M||(M=Ye(),M.c(),M.m(c,l)):M&&(M.d(1),M=null),I===(I=H(w))&&C?C.p(w,W):(C.d(1),C=I(w),C&&(C.c(),C.m(c,null))),(!p||W[0]&16)&&O(n,"width",w[4]-2+"px");const ne={};W[0]&1&&(ne.window=w[0]),W[0]&4&&(ne.notImportant=w[2]),f.$set(ne),(!p||W[0]&16)&&O(e,"width",w[4]+"px"),(!p||W[0]&32)&&O(e,"left",w[5]+"px"),(!p||W[0]&64)&&O(e,"top",w[6]+"px"),(!p||W[0]&128)&&O(e,"z-index",w[7])},i(w){p||(X(f.$$.fragment,w),p=!0)},o(w){q(f.$$.fragment,w),p=!1},d(w){w&&k(e),y&&y.d(),T.d(),A&&A.d(),M&&M.d(),C.d(),t[26](null),Q(f),t[27](null),r=!1,$(h)}}}function je(t){let e,n,s;return{c(){e=b("img"),fe(e.src,n=t[8])||m(e,"src",n),m(e,"alt",s=t[9]+" icon"),m(e,"height",18),m(e,"width",18),m(e,"class","ml-1.5")},m(i,o){E(i,e,o)},p(i,o){o[0]&256&&!fe(e.src,n=i[8])&&m(e,"src",n),o[0]&512&&s!==(s=i[9]+" icon")&&m(e,"alt",s)},d(i){i&&k(e)}}}function Wt(t){let e,n;return{c(){e=b("span"),n=pe(t[9]),m(e,"class","pl-2 text-gray-400")},m(s,i){E(s,e,i),v(e,n)},p(s,i){i[0]&512&&We(n,s[9])},d(s){s&&k(e)}}}function xt(t){let e,n;return{c(){e=b("span"),n=pe(t[9]),m(e,"class","pl-2")},m(s,i){E(s,e,i),v(e,n)},p(s,i){i[0]&512&&We(n,s[9])},d(s){s&&k(e)}}}function Xe(t){let e;return{c(){e=b("span"),e.textContent="_",m(e,"class","pr-1.5")},m(n,s){E(n,e,s)},d(n){n&&k(e)}}}function Ye(t){let e;return{c(){e=b("span"),e.textContent="â–¡",m(e,"class","pr-1.5")},m(n,s){E(n,e,s)},d(n){n&&k(e)}}}function St(t){let e;return{c(){e=b("span"),e.textContent="x",m(e,"class","text-gray-500")},m(n,s){E(n,e,s)},p:P,d(n){n&&k(e)}}}function Tt(t){let e,n,s;return{c(){e=b("span"),e.textContent="x"},m(i,o){E(i,e,o),n||(s=j(e,"mouseup",t[25]),n=!0)},p:P,d(i){i&&k(e),n=!1,s()}}}function At(t){let e,n,s=t[3]&&Oe(t);return{c(){s&&s.c(),e=Ce()},m(i,o){s&&s.m(i,o),E(i,e,o),n=!0},p(i,o){i[3]?s?(s.p(i,o),o[0]&8&&X(s,1)):(s=Oe(i),s.c(),X(s,1),s.m(e.parentNode,e)):s&&(xe(),q(s,1,1,()=>{s=null}),Se())},i(i){n||(X(s),n=!0)},o(i){q(s),n=!1},d(i){s&&s.d(i),i&&k(e)}}}function Ue(t){let e=0,n=0;if(t instanceof MouseEvent)e=t.pageX,n=t.pageY;else if(t instanceof TouchEvent){const s=t.touches[0];e=s.pageX,n=s.pageY}return[e,n]}function Lt(t,e,n){let s,i,o,u,c,a,l,d,f,p,{window:r}=e,{classes:h,title:y,icon:x,x:z,y:T,width:A,height:M,style:H,controlButtons:I,isVisible:C,zIndex:w}=r.stores;B(t,y,g=>n(9,d=g)),B(t,x,g=>n(8,l=g)),B(t,z,g=>n(5,u=g)),B(t,T,g=>n(6,c=g)),B(t,A,g=>n(4,o=g)),B(t,I,g=>n(11,p=g)),B(t,C,g=>n(3,i=g)),B(t,w,g=>n(7,a=g));let W,ne,Te,ye=!1;$e(()=>{n(0,r.zIndex=ae(),r)});function ot(){s||(L.activeWindowStore.set(r),r.zIndex<=Ve()&&n(0,r.zIndex=ae(),r))}let{activeWindowStore:Ae}=L;B(t,Ae,g=>n(10,f=g));function rt(g){if(s||g instanceof MouseEvent&&g.button!==0)return;let[Y,ke]=Ue(g);const he=document.body,Le=W.getBoundingClientRect();ne=Y-(Le.left+he.scrollLeft-he.clientLeft),Te=ke-(Le.top+he.scrollTop-he.clientTop),ye=!0,r.zIndex<=Ve()&&n(0,r.zIndex=ae(),r),g instanceof MouseEvent&&g.preventDefault(),document.addEventListener("mousemove",Z=>{le(Z)}),document.addEventListener("mouseup",Z=>{re(Z)}),document.addEventListener("touchmove",Z=>{le(Z)},{passive:!1}),document.addEventListener("touchend",Z=>{re(Z)},{passive:!1})}function re(g){g instanceof MouseEvent&&g.button!==0||(ye=!1,g instanceof MouseEvent&&g.preventDefault(),document.removeEventListener("mousemove",Y=>{le(Y)}),document.removeEventListener("mouseup",Y=>{re(Y)}),document.removeEventListener("touchmove",Y=>{le(Y)}),document.removeEventListener("touchend",Y=>{re(Y)}))}function le(g){if(s||!ye)return;let[Y,ke]=Ue(g);n(0,r.x=Y-(ne??0),r),n(0,r.y=ke-(Te??0),r),g.preventDefault()}const lt=()=>r.close();function ct(g){be[g?"unshift":"push"](()=>{W=g,n(1,W)})}function ut(g){be[g?"unshift":"push"](()=>{r.windowElement=g,n(0,r)})}return t.$$set=g=>{"window"in g&&n(0,r=g.window)},t.$$.update=()=>{t.$$.dirty[0]&1&&n(2,s=r.process.getImportantWindows().length!=0&&!r.important)},[r,W,s,i,o,u,c,a,l,d,f,p,y,x,z,T,A,I,C,w,ot,Ae,rt,re,le,lt,ct,ut]}class Pt extends te{constructor(e){super(),ee(this,e,Lt,At,F,{window:0},null,[-1,-1])}}function qe(t,e,n){const s=t.slice();return s[3]=e[n],s}function De(t,e){let n,s,i;return s=new Pt({props:{window:e[3]}}),{key:t,first:null,c(){n=Ce(),oe(s.$$.fragment),this.first=n},m(o,u){E(o,n,u),J(s,o,u),i=!0},p(o,u){e=o;const c={};u&1&&(c.window=e[3]),s.$set(c)},i(o){i||(X(s.$$.fragment,o),i=!0)},o(o){q(s.$$.fragment,o),i=!1},d(o){o&&k(n),Q(s,o)}}}function Mt(t){let e=[],n=new Map,s,i,o=t[0];const u=c=>c[3];for(let c=0;c<o.length;c+=1){let a=qe(t,o,c),l=u(a);n.set(l,e[c]=De(l,a))}return{c(){for(let c=0;c<e.length;c+=1)e[c].c();s=Ce()},m(c,a){for(let l=0;l<e.length;l+=1)e[l].m(c,a);E(c,s,a),i=!0},p(c,[a]){a&1&&(o=c[0],xe(),e=tt(e,a,u,1,c,o,n,s.parentNode,bt,De,s,qe),Se())},i(c){if(!i){for(let a=0;a<o.length;a+=1)X(e[a]);i=!0}},o(c){for(let a=0;a<e.length;a+=1)q(e[a]);i=!1},d(c){for(let a=0;a<e.length;a+=1)e[a].d(c);c&&k(s)}}}function Bt(t,e,n){let s,i,o=L.windowsStore;return B(t,o,u=>n(2,i=u)),t.$$.update=()=>{t.$$.dirty&4&&n(0,s=i)},[s,o,i]}class Vt extends te{constructor(e){super(),ee(this,e,Bt,Mt,F,{})}}const st="/assets/mastrielIcon-6c62ac08.svg",ie=class{constructor(e,n,s=st){this.name=e,this.mainWindow=n,this.icon=s}};let U=ie;_(U,"registeredApps",[]),_(U,"registerApp",e=>{ie.registeredApps.push(e)}),_(U,"getApp",e=>ie.registeredApps.find(n=>n.name==e)),_(U,"getAllApps",()=>[...ie.registeredApps]),_(U,"getAppByType",e=>{let n=ie.registeredApps.find(s=>s instanceof e);if(n==null)throw new Error("Invalid app specified. Is it registered?");return n});let Re=0;function Nt(){return Re++,Re-1}function Fe(t){let e,n,s;return{c(){e=b("button"),e.textContent="Continue"},m(i,o){E(i,e,o),n||(s=j(e,"mousedown",t[3]),n=!0)},p:P,d(i){i&&k(e),n=!1,s()}}}function Ot(t){let e,n,s,i,o=t[0].message+"",u,c,a,l,d,f,p,r=!t[0].unrecoverable&&Fe(t);return{c(){e=b("div"),n=b("div"),s=b("div"),i=b("span"),u=pe(o),c=S(),a=b("div"),r&&r.c(),l=S(),d=b("button"),d.textContent="End Process",m(i,"class","text-center error-message whitespace-pre-line select-text svelte-wbgunv"),m(i,"style",""),m(s,"class","flex justify-center"),m(n,"class","h-20 error-message overflow-y-scroll scrollbar-hide svelte-wbgunv"),O(n,"width",t[1]+"px"),m(e,"class","bg-red-800 border-b border-b-red-700 pt-3 drop-shadow-xl"),m(a,"class","flex justify-around pt-5")},m(h,y){E(h,e,y),v(e,n),v(n,s),v(s,i),v(i,u),E(h,c,y),E(h,a,y),r&&r.m(a,null),v(a,l),v(a,d),f||(p=j(d,"mousedown",t[4]),f=!0)},p(h,[y]){y&1&&o!==(o=h[0].message+"")&&We(u,o),y&2&&O(n,"width",h[1]+"px"),h[0].unrecoverable?r&&(r.d(1),r=null):r?r.p(h,y):(r=Fe(h),r.c(),r.m(a,l))},i:P,o:P,d(h){h&&k(e),h&&k(c),h&&k(a),r&&r.d(),f=!1,p()}}}function jt(t,e,n){let s,{process:i}=e,{window:o}=e,{width:u}=o.stores;B(t,u,l=>n(1,s=l)),o.classes="bg-red-900",o.title=o.errorTitle,o.important=!0,o.controlButtons={maximize:!1,minimize:!1,close:!1},L.activeWindow=o;const c=()=>{o.close(),L.activeWindow=i.mainWindow},a=()=>{i.kill()};return t.$$set=l=>{"process"in l&&n(5,i=l.process),"window"in l&&n(0,o=l.window)},[o,s,u,c,a,i]}class Xt extends te{constructor(e){super(),ee(this,e,jt,Ot,F,{process:5,window:0})}}class He extends L{constructor(e,n,s=!1){super(500,500,400,160,Xt),this.errorTitle=e,this.message=n,this.unrecoverable=s}}const K=class{constructor(e,n,s){_(this,"id");_(this,"app");_(this,"mainWindow");_(this,"options");_(this,"spawnWindow",e=>L.spawn(e,this));_(this,"kill",()=>{for(const e of this.getWindows())e.close();K.processesStore.update(e=>e.filter(n=>n!=this))});_(this,"crash",e=>{this.spawnWindow(new He("Fatal Error",`${this.app.name} has crashed:
${e}`,!0))});_(this,"error",e=>{this.spawnWindow(new He("Error",`An error has occurred in ${this.app.name}:
${e}


hi`,!1))});this.id=n,this.app=e,s!=null&&(this.options=s)}getWindows(){return L.getWindows().filter(e=>e.process==this)??[]}getImportantWindows(){return this.getWindows().filter(e=>e.important)??[]}static mergeOptions(e,n){return{...n,...e}}};let R=K;_(R,"processesStore",N([])),_(R,"getProcesses",()=>V(K.processesStore)),_(R,"spawn",(e,n)=>{let s=U.getAppByType(e),i=K.mergeOptions(n,e.defaultOptions),o=new K(s,Nt(),i);K.processesStore.update(c=>[...c,o]);let u=new L(300,300,400,400,s.mainWindow);return o.mainWindow=L.spawn(u,o),o});function Ze(t,e,n){const s=t.slice();return s[10]=e[n],s}function Yt(t){let e;return{c(){e=b("span"),e.textContent=".",m(e,"class","text-center block")},m(n,s){E(n,e,s)},d(n){n&&k(e)}}}function Ut(t){let e;return{c(){e=b("span"),e.textContent="_",m(e,"class","text-center block")},m(n,s){E(n,e,s)},d(n){n&&k(e)}}}function Ke(t,e){let n,s,i,o,u,c,a,l,d,f;function p(x,z){return z&3&&(c=null),c==null&&(c=!!x[0](x[10])),c?Ut:Yt}let r=p(e,-1),h=r(e);function y(){return e[6](e[10])}return{key:t,first:null,c(){n=b("div"),s=b("img"),u=S(),h.c(),a=S(),fe(s.src,i=e[10].app.icon)||m(s,"src",i),m(s,"width","30"),m(s,"height","30"),m(s,"alt",o=`${e[10].app.name}`),m(s,"class","translate-y-2.5"),m(n,"class",l=(e[0](e[10])?"selected":"unselected")+" process svelte-1h8nwke"),this.first=n},m(x,z){E(x,n,z),v(n,s),v(n,u),h.m(n,null),v(n,a),d||(f=j(n,"click",y),d=!0)},p(x,z){e=x,z&2&&!fe(s.src,i=e[10].app.icon)&&m(s,"src",i),z&2&&o!==(o=`${e[10].app.name}`)&&m(s,"alt",o),r!==(r=p(e,z))&&(h.d(1),h=r(e),h&&(h.c(),h.m(n,a))),z&3&&l!==(l=(e[0](e[10])?"selected":"unselected")+" process svelte-1h8nwke")&&m(n,"class",l)},d(x){x&&k(n),h.d(),d=!1,f()}}}function qt(t){let e,n,s,i,o,u,c=[],a=new Map,l=t[1];const d=f=>f[10];for(let f=0;f<l.length;f+=1){let p=Ze(t,l,f),r=d(p);a.set(r,c[f]=Ke(r,p))}return{c(){e=b("div"),e.innerHTML='<div class="h-12 w-screen z-0 bg-taskbar svelte-1h8nwke"></div>',n=S(),s=b("div"),s.innerHTML='<div class="h-12 w-screen max-z-index bg-taskbar-blur svelte-1h8nwke"></div>',i=S(),o=b("div"),u=b("div");for(let f=0;f<c.length;f+=1)c[f].c();m(e,"class","fixed bottom-0 z-0"),m(s,"class","fixed bottom-0 max-z-index svelte-1h8nwke"),m(u,"class","h-12 w-screen max-z-index taskbar-contents flex items-center justify-center gap-1 svelte-1h8nwke"),m(o,"class","fixed bottom-0 max-z-index svelte-1h8nwke")},m(f,p){E(f,e,p),E(f,n,p),E(f,s,p),E(f,i,p),E(f,o,p),v(o,u);for(let r=0;r<c.length;r+=1)c[r].m(u,null)},p(f,[p]){p&19&&(l=f[1],c=tt(c,p,d,1,f,l,a,u,gt,Ke,null,Ze))},i:P,o:P,d(f){f&&k(e),f&&k(n),f&&k(s),f&&k(i),f&&k(o);for(let p=0;p<c.length;p+=1)c[p].d()}}}function Dt(t,e,n){let s,i,o,u=R.processesStore;B(t,u,r=>n(1,o=r));let c=L.activeWindowStore;B(t,c,r=>n(5,i=r));const a=r=>{s(r)?d(r):(l(r),f(r))},l=r=>{console.log(r),r.getWindows().forEach(h=>{h.unhide(),h.zIndex=ae()})},d=r=>{r.getWindows().forEach(h=>{h.hide(),c.set(void 0)})},f=r=>{c.set(r.mainWindow),console.log("Focus!"),r.getWindows().sort(h=>h.zIndex).forEach(h=>{console.log("Window!"),h.zIndex=ae()})},p=r=>a(r);return t.$$.update=()=>{t.$$.dirty&32&&n(0,s=r=>(i==null?void 0:i.process)===r)},[s,o,u,c,a,i,p]}class Rt extends te{constructor(e){super(),ee(this,e,Dt,qt,F,{})}}function Ft(t){let e,n,s,i,o,u,c,a,l;return u=new Vt({}),a=new Rt({}),{c(){e=b("div"),n=b("img"),i=S(),o=b("div"),oe(u.$$.fragment),c=S(),oe(a.$$.fragment),fe(n.src,s=st)||m(n,"src",s),m(n,"alt","Site icon"),m(n,"height",256),m(n,"width",256),m(n,"class","drop-shadow-3xl"),m(e,"class","flex items-center justify-center h-screen w-screen absolute"),m(o,"class","absolute")},m(d,f){E(d,e,f),v(e,n),E(d,i,f),E(d,o,f),J(u,o,null),E(d,c,f),J(a,d,f),l=!0},p:P,i(d){l||(X(u.$$.fragment,d),X(a.$$.fragment,d),l=!0)},o(d){q(u.$$.fragment,d),q(a.$$.fragment,d),l=!1},d(d){d&&k(e),d&&k(i),d&&k(o),Q(u),d&&k(c),Q(a,d)}}}class Ht extends te{constructor(e){super(),ee(this,e,null,Ft,F,{})}}function Zt(t){return t[Math.floor(Math.random()*t.length)]}const it="/assets/consoleIcon-9d1dc8de.svg",Kt=t=>new Promise(e=>setTimeout(e,t));function Gt(t){let e,n,s,i,o,u,c,a,l,d,f,p,r,h,y,x;return{c(){e=b("div"),n=b("span"),n.textContent="Remove process",s=S(),i=b("span"),i.textContent="Update color",o=S(),u=b("span"),u.textContent="Update title",c=S(),a=b("span"),a.textContent="Spawn another",l=S(),d=b("span"),d.textContent="Show error",f=S(),p=b("span"),p.textContent="Show unrecoverable error",r=S(),h=b("span"),h.textContent="Turn invisible temporarily",m(n,"class","link svelte-18apmpb"),m(i,"class","link svelte-18apmpb"),m(u,"class","link svelte-18apmpb"),m(a,"class","link svelte-18apmpb"),m(d,"class","link svelte-18apmpb"),m(p,"class","link svelte-18apmpb"),m(h,"class","link svelte-18apmpb"),m(e,"class","pt-2 pl-3 options svelte-18apmpb")},m(z,T){E(z,e,T),v(e,n),v(e,s),v(e,i),v(e,o),v(e,u),v(e,c),v(e,a),v(e,l),v(e,d),v(e,f),v(e,p),v(e,r),v(e,h),y||(x=[j(n,"click",t[0]),j(i,"click",t[2]),j(u,"click",t[3]),j(a,"click",t[1]),j(d,"click",t[4]),j(p,"click",t[5]),j(h,"click",t[6])],y=!0)},p:P,i:P,o:P,d(z){z&&k(e),y=!1,$(x)}}}function Jt(t,e,n){let{process:s}=e,{window:i}=e,o=s.options;i.icon=it,i.style="background-color: "+o.backgroundColor;let u;$e(()=>{u=0});function c(){s.kill(),console.log("Process killed!")}const a=()=>{let h=R.spawn(ve);console.log("New process spawned!"),console.log(h),L.activeWindow=h.mainWindow},l=()=>{let h=["bg-red","bg-blue","bg-lime","bg-black"];n(7,i.classes=Zt(h),i),console.log("Color updated!")},d=()=>{u+=1,n(7,i.title=u.toString(),i),console.log("Title updated!")},f=()=>{s.error("User has initiated an error.")},p=()=>{s.crash("User has forced a crash.")},r=async()=>{n(7,i.isVisible=!1,i),await Kt(3e3),n(7,i.isVisible=!0,i)};return t.$$set=h=>{"process"in h&&n(8,s=h.process),"window"in h&&n(7,i=h.window)},[c,a,l,d,f,p,r,i,s]}class Qt extends te{constructor(e){super(),ee(this,e,Jt,Gt,F,{process:8,window:7})}}class ve extends U{constructor(){super("Console",Qt,it)}}_(ve,"defaultOptions",{backgroundColor:"#000000"});new Ht({target:document.getElementById("app")});U.registerApp(new ve);R.spawn(ve,{backgroundColor:"#1a1d1e"});
